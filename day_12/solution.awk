#!/usr/bin/awk -f

function P(l,o,t){$0=k;z~M[t=$1+t FS o+$2]||M[t]-M[k]>1||v[t,n]++||l[t]}
function B(f,s){for(k in f)if(k==P(s,i=-1)P(s,0,i)P(s,P(s,1),1)E)print d
++i||++d B(s)}END{d=n=B(a);B(b)}{for(gsub(n=z,FS);$++n;$n~/E/&&M[E=k]--)
(M[k=NR FS n]=index("bcdefghijklmnopqrstuvwxyzE",$n))||b[k]$n~/S/&&a[k]}
