#!/usr/bin/awk -f

END{while(0~O){for(i in E){$0=i;e=$2;for(O=$0=q=j="-1 -1 1 1 1 0 -1 1 0 -1 1";
++j<y=12;q-=i+$(p=(B*3+j)%y)FS$((p+6)%y)+e in E)j%3||q*=10;q<-1e4&&(j=index(q,
0))&&(q=i+$(p=(B-3+j)%4*3)FS$((p+6)%y)+e)&&f[q]=f[q]i;if(9~B){--i<a&&a=i;i>P&&
P=i;e<t&&t=e;e>=d&&d=e+1}}for(k in f){$0=f[k];if(NF<3)delete E[E[k]$(O=0)]}++B
delete f}print(P-a+1)*(d-t)-A"\n"B}{for(gsub(l=z,FS);$++l;)0~$l||E[NR" "l]A++}
